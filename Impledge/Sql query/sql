-- Update Queries
-- Update the attending_doctor_id to 29 where it is currently 3
UPDATE Admissions
SET attending_doctor_id = 29
WHERE attending_doctor_id = 3;

-- Update the patient_id to 4 where it is currently 35
UPDATE Admissions
SET patient_id = 4
WHERE patient_id = 35;

-- Doctors with Admissions
-- Retrieve details of doctors who have at least one admission assigned to them
SELECT DISTINCT d.*
FROM Doctors d
JOIN Admissions a ON d.doctor_id = a.attending_doctor_id;

-- Doctors without Admissions
-- Retrieve details of doctors who do not have any admissions assigned to them
SELECT d.*
FROM Doctors d
LEFT JOIN Admissions a ON d.doctor_id = a.attending_doctor_id
WHERE a.attending_doctor_id IS NULL;

-- Patients with Missing Doctor Details
-- Retrieve details of patients whose admissions have missing doctor details (i.e., no assigned attending doctor)
SELECT p.*
FROM Patients p
JOIN Admissions a ON p.patient_id = a.patient_id
LEFT JOIN Doctors d ON a.attending_doctor_id = d.doctor_id
WHERE d.doctor_id IS NULL;